{
  "createdAt": "2025-05-11T04:24:59.498Z",
  "updatedAt": "2025-05-11T07:31:55.000Z",
  "id": "hy09bnAmgocA7SJi",
  "name": "backup-credentials-and-workflows",
  "active": false,
  "nodes": [
    {
      "parameters": {},
      "name": "On clicking 'execute'",
      "type": "n8n-nodes-base.manualTrigger",
      "position": [
        -40,
        80
      ],
      "typeVersion": 1,
      "id": "1cca19d9-1636-4da9-8376-f85becb02161"
    },
    {
      "parameters": {
        "command": "npx n8n export:workflow --backup --output /home/node/n8n_backup/workflows/ --pretty"
      },
      "name": "Export Workflows",
      "type": "n8n-nodes-base.executeCommand",
      "position": [
        400,
        80
      ],
      "typeVersion": 1,
      "id": "a7c39d78-34d6-4ea3-90e6-e110509555cc"
    },
    {
      "parameters": {
        "command": "npx n8n export:credentials --backup --output /home/node/n8n_backup/credentials/"
      },
      "name": "Export Credentials",
      "type": "n8n-nodes-base.executeCommand",
      "position": [
        620,
        80
      ],
      "typeVersion": 1,
      "id": "349363bb-5f05-4773-b04c-7a13540c1ced"
    },
    {
      "parameters": {
        "command": "git -C n8n_backup add ."
      },
      "name": "git add",
      "type": "n8n-nodes-base.executeCommand",
      "position": [
        1060,
        80
      ],
      "typeVersion": 1,
      "id": "010238b7-9db9-4adb-99eb-affcb04349f4"
    },
    {
      "parameters": {
        "command": "=git -C n8n_backup commit -m \"Auto backup ({{ new Date().toISOString() }})\""
      },
      "name": "git commit",
      "type": "n8n-nodes-base.executeCommand",
      "position": [
        1280,
        80
      ],
      "typeVersion": 1,
      "id": "fd6ba455-bacf-4678-b6ee-ef8668357b1d"
    },
    {
      "parameters": {
        "command": "git -C n8n_backup push"
      },
      "name": "git push",
      "type": "n8n-nodes-base.executeCommand",
      "position": [
        1500,
        80
      ],
      "typeVersion": 1,
      "id": "67496eba-5047-4698-aa86-e8fe23da6a07"
    },
    {
      "parameters": {
        "triggerTimes": {
          "item": [
            {
              "hour": 0
            },
            {
              "hour": 12
            },
            {
              "hour": 6
            },
            {
              "hour": 18
            }
          ]
        }
      },
      "name": "Cron",
      "type": "n8n-nodes-base.cron",
      "position": [
        -40,
        -180
      ],
      "typeVersion": 1,
      "id": "8f85de2f-434c-46db-8256-75387b2d5092",
      "disabled": true
    },
    {
      "parameters": {
        "command": "mkdir -p /home/node/n8n_backup/workflows && rm -f /home/node/n8n_backup/workflows/*.json && mkdir -p /home/node/n8n_backup/credentials && rm -f /home/node/n8n_backup/credentials/*.json"
      },
      "type": "n8n-nodes-base.executeCommand",
      "typeVersion": 1,
      "position": [
        180,
        80
      ],
      "id": "225cb0c2-4578-47df-bf30-0d00152db24d",
      "name": "create Folder and remove old json"
    },
    {
      "parameters": {
        "command": "sh -c \"\nrename_files() {\n  DIR=\\\"\\$1\\\"\n  echo \\\"üîÑ X·ª≠ l√Ω th∆∞ m·ª•c \\$DIR...\\\"\n  \n  for file in \\\"\\$DIR\\\"/*.json; do\n    [ ! -f \\\"\\$file\\\" ] && continue\n    \n    name=\\$(jq -r '.name' \\\"\\$file\\\" 2>/dev/null)\n    [ -z \\\"\\$name\\\" ] || [ \\\"\\$name\\\" = \\\"null\\\" ] && continue\n    \n    safe_name=\\$(echo \\\"\\$name\\\" | tr '[:upper:]' '[:lower:]' | sed -e 's/[^a-z0-9]/-/g' -e 's/-\\\\+/-/g' -e 's/^-//' -e 's/-\\$//')\n    new_path=\\\"\\$DIR/\\$safe_name.json\\\"\n    \n    if [ \\\"\\$file\\\" != \\\"\\$new_path\\\" ]; then\n      mv -n \\\"\\$file\\\" \\\"\\$new_path\\\"\n      echo \\\"‚úÖ ƒê√£ ƒë·ªïi: \\$(basename \\\"\\$file\\\") ‚Üí \\$(basename \\\"\\$new_path\\\")\\\"\n    fi\n  done\n}\n\n# Th·ª±c thi cho c·∫£ 2 th∆∞ m·ª•c\nrename_files '/home/node/n8n_backup/credentials'\nrename_files '/home/node/n8n_backup/workflows'\n\""
      },
      "type": "n8n-nodes-base.executeCommand",
      "typeVersion": 1,
      "position": [
        840,
        80
      ],
      "id": "4f58bdd3-c000-48d1-8327-2ea37d5c0c83",
      "name": "rename workflow and credentials"
    }
  ],
  "connections": {
    "Cron": {
      "main": [
        []
      ]
    },
    "git add": {
      "main": [
        [
          {
            "node": "git commit",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "git commit": {
      "main": [
        [
          {
            "node": "git push",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Export Workflows": {
      "main": [
        [
          {
            "node": "Export Credentials",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Export Credentials": {
      "main": [
        [
          {
            "node": "rename workflow and credentials",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "On clicking 'execute'": {
      "main": [
        [
          {
            "node": "create Folder and remove old json",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "git push": {
      "main": [
        []
      ]
    },
    "create Folder and remove old json": {
      "main": [
        [
          {
            "node": "Export Workflows",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "rename workflow and credentials": {
      "main": [
        [
          {
            "node": "git add",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "settings": {
    "executionOrder": "v1"
  },
  "staticData": null,
  "meta": null,
  "pinData": {},
  "versionId": "14e4d887-9882-4ef9-94d6-ac365609e44f",
  "triggerCount": 0,
  "tags": []
}